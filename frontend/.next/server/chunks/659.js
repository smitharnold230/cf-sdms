exports.id=659,exports.ids=[659],exports.modules={7861:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},9654:(e,t,r)=>{Promise.resolve().then(r.bind(r,381)),Promise.resolve().then(r.bind(r,4001)),Promise.resolve().then(r.bind(r,2751))},4001:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>c,a:()=>d});var a=r(326),o=r(7577),i=r(8069),s=r(381);let n=(0,o.createContext)(void 0);function c({children:e}){let[t,r]=(0,o.useState)(null),[c,d]=(0,o.useState)(!0),l=async e=>{try{d(!0);let t=await i.iJ.login(e),a={...t.user,token:t.token};r(a),localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),s.ZP.success("Login successful!")}catch(e){throw s.ZP.error(e.response?.data?.message||"Login failed"),e}finally{d(!1)}},u=async e=>{try{d(!0),await i.iJ.register(e),s.ZP.success("Registration successful! Please login.")}catch(e){throw s.ZP.error(e.response?.data?.message||"Registration failed"),e}finally{d(!1)}};return a.jsx(n.Provider,{value:{user:t,loading:c,login:l,register:u,logout:()=>{r(null),localStorage.removeItem("token"),localStorage.removeItem("user"),s.ZP.success("Logged out successfully")},isAuthenticated:!!t,hasRole:e=>!!t&&e.includes(t.role)},children:e})}function d(){let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2751:(e,t,r)=>{"use strict";r.d(t,{NotificationProvider:()=>d,z:()=>l});var a=r(326),o=r(7577),i=r(8069),s=r(4001),n=r(381);r(4659),r(997),r(7888),r(8019);let c=(0,o.createContext)(void 0);function d({children:e}){let{user:t,isAuthenticated:r}=(0,s.a)(),[d,l]=(0,o.useState)([]),[u,p]=(0,o.useState)(0),{isConnected:f,connectionError:g}=function(e={}){let{user:t,isAuthenticated:r}=(0,s.a)(),{onNotification:a,autoConnect:i=!0}=e,[c,d]=(0,o.useState)(!1),[l,u]=(0,o.useState)(null),p=(0,o.useRef)(null),f=(0,o.useRef)(null),g=(0,o.useRef)(0),m=()=>{if(r&&t&&p.current?.readyState!==WebSocket.OPEN)try{let e=process.env.NEXT_PUBLIC_WS_URL||"ws://127.0.0.1:8787",r=localStorage.getItem("token");if(!r){u("No authentication token available");return}let o=new WebSocket(`${e}/api/notifications/ws?token=${r}&userId=${t.id}`);p.current=o,o.onopen=()=>{console.log("WebSocket connected for real-time notifications"),d(!0),u(null),g.current=0,o.send(JSON.stringify({type:"ping",userId:t.id,timestamp:Date.now()}))},o.onmessage=e=>{try{let t=JSON.parse(e.data);switch(t.type){case"notification":let r=t.notification;a&&a(r),h(r);break;case"pong":console.log("WebSocket pong received");break;case"error":console.error("WebSocket error message:",t.message),u(t.message);break;default:console.log("Unknown WebSocket message type:",t.type)}}catch(e){console.error("Failed to parse WebSocket message:",e)}},o.onclose=e=>{if(console.log("WebSocket disconnected:",e.code,e.reason),d(!1),p.current=null,1e3!==e.code&&g.current<5){let e=Math.min(1e3*Math.pow(2,g.current),3e4);console.log(`Attempting to reconnect in ${e}ms (attempt ${g.current+1})`),f.current=setTimeout(()=>{g.current++,m()},e)}else g.current>=5&&u("Failed to reconnect after multiple attempts")},o.onerror=e=>{console.error("WebSocket error:",e),u("Connection error occurred")}}catch(e){console.error("Failed to connect to WebSocket:",e),u("Failed to establish connection")}},h=e=>{var t;let r=(t=e.type,"urgent"===e.priority?"error":"certificate"===t&&e.message.includes("approved")?"success":"certificate"===t&&e.message.includes("rejected")?"error":"points"===t?"success":"system"===t?"error":"default"),a=`${e.title}
${e.message}${"urgent"===e.priority?" (URGENT)":""}`;switch(r){case"success":n.ZP.success(a,{duration:5e3});break;case"error":n.ZP.error(a,{duration:7e3});break;default:(0,n.ZP)(a,{duration:4e3})}"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission(),"urgent"===e.priority&&"Notification"in window&&"granted"===Notification.permission&&new Notification(e.title,{body:e.message,icon:"/favicon.ico",tag:`notification-${e.id}`})};return{isConnected:c,connectionError:l,connect:m,disconnect:()=>{f.current&&(clearTimeout(f.current),f.current=null),p.current&&(p.current.close(1e3,"User disconnected"),p.current=null),d(!1),u(null),g.current=0},sendPing:()=>{p.current?.readyState===WebSocket.OPEN&&t&&p.current.send(JSON.stringify({type:"ping",userId:t.id,timestamp:Date.now()}))}}}({onNotification:e=>{l(t=>[e,...t])},autoConnect:!0}),m=async e=>{try{await i.BT.markAsRead(e),l(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t))}catch(e){console.error("Failed to mark notification as read:",e)}},h=async()=>{if(t)try{await i.BT.markAllAsRead(t.id),l(e=>e.map(e=>({...e,is_read:!0})))}catch(e){console.error("Failed to mark all notifications as read:",e)}},w=async()=>{if(t)try{let e=await i.BT.getNotifications(t.id);l(e.notifications)}catch(e){console.error("Failed to refresh notifications:",e)}},y=d.filter(e=>!e.is_read).length;return a.jsx(c.Provider,{value:{notifications:d,unreadCount:y,markAsRead:m,markAllAsRead:h,refreshNotifications:w,isConnected:f,connectionError:g},children:e})}function l(){let e=(0,o.useContext)(c);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e}},8069:(e,t,r)=>{"use strict";r.d(t,{Aw:()=>n,BT:()=>d,Hc:()=>i,Wp:()=>c,iJ:()=>o,vd:()=>s});let a=r(4464).Z.create({baseURL:"http://127.0.0.1:8787",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),a.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),Promise.reject(e)));let o={login:async e=>(await a.post("/auth/login",e)).data,register:async e=>(await a.post("/auth/register",e)).data},i={uploadCertificate:async e=>{let t=new FormData;return t.append("file",e.file),(await a.post(`/certificates/upload?user_id=${e.user_id}&title=${encodeURIComponent(e.title)}&issued_date=${e.issued_date}`,t,{headers:{"Content-Type":"application/pdf"}})).data},getUserCertificates:async e=>(await a.get(`/users/${e}/certificates`)).data,downloadCertificate:async e=>(await a.get(`/certificates/${e}/download`,{responseType:"blob"})).data,deleteCertificate:async e=>(await a.delete(`/certificates/${e}`)).data,reviewCertificate:async(e,t,r)=>(await a.put(`/certificates/${e}/review`,{status:t,rejection_reason:r})).data},s={getEvents:async()=>({events:(await a.get("/api/events")).data}),createEvent:async e=>{let t=await a.post("/api/faculty/events",e);return{event:{...e,id:t.data.eventId}}}},n={getWorkshops:async()=>{try{return{workshops:(await a.get("/api/workshops")).data}}catch(e){return{workshops:[]}}},createWorkshop:async(e,t)=>{let r=await a.post(`/api/faculty/workshops?eventId=${e}`,t);return{workshop:{...t,id:r.data.workshopId,event_id:e}}}},c={getUserPoints:async e=>{let t=await a.get(`/api/analytics/user?userId=${e}`);return{total_points:t.data.data.totalPoints,entries:t.data.data.pointsHistory}},addPoints:async(e,t,r)=>(await a.post("/api/admin/award-points",{userId:e,points:t,reason:r})).data},d={getNotifications:async e=>(await a.get(`/api/notifications/${e}`)).data,markAsRead:async e=>(await a.put(`/api/notifications/${e}/read`)).data,markAllAsRead:async e=>(await a.put(`/api/notifications/${e}/read-all`)).data,getPreferences:async e=>(await a.get(`/api/notifications/${e}/preferences`)).data,updatePreferences:async(e,t)=>(await a.put(`/api/notifications/${e}/preferences`,t)).data}},4244:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d,metadata:()=>c});var a=r(9510);r(4315);var o=r(8570);let i=(0,o.createProxy)(String.raw`C:\Users\Arnold E\Downloads\sd-dep\frontend\src\contexts\AuthContext.tsx#AuthProvider`);(0,o.createProxy)(String.raw`C:\Users\Arnold E\Downloads\sd-dep\frontend\src\contexts\AuthContext.tsx#useAuth`);let s=(0,o.createProxy)(String.raw`C:\Users\Arnold E\Downloads\sd-dep\frontend\src\contexts\NotificationContext.tsx#NotificationProvider`);(0,o.createProxy)(String.raw`C:\Users\Arnold E\Downloads\sd-dep\frontend\src\contexts\NotificationContext.tsx#useNotifications`);var n=r(9125);let c={title:"Student Database Management System",description:"A comprehensive SDMS for managing student certificates, points, and academic progress"};function d({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{children:a.jsx(i,{children:(0,a.jsxs)(s,{children:[e,a.jsx(n.x7,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#374151",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"}}})]})})})})}},4315:()=>{}};