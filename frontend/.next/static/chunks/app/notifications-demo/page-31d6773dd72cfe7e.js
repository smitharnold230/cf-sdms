(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[732],{8979:function(e,s,t){Promise.resolve().then(t.bind(t,3174))},3174:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Z}});var r=t(7437),a=t(2265),i=t(5302),l=t(5131),n=t(3639),c=t(1723),d=t(3245),o=t(4766),x=t(2489),m=t(9879),u=t(2389),h=t(1994);function f(e){let{className:s}=e,[t,f]=(0,a.useState)(!1),{notifications:g,unreadCount:p,markAsRead:b,markAllAsRead:j,refreshNotifications:y}=(0,m.z)(),N=e=>{switch(e){case"success":return(0,r.jsx)(i.Z,{className:"w-5 h-5 text-green-500"});case"error":return(0,r.jsx)(l.Z,{className:"w-5 h-5 text-red-500"});case"warning":return(0,r.jsx)(n.Z,{className:"w-5 h-5 text-yellow-500"});case"deadline":return(0,r.jsx)(c.Z,{className:"w-5 h-5 text-orange-500"});default:return(0,r.jsx)(d.Z,{className:"w-5 h-5 text-blue-500"})}},v=e=>{switch(e){case"urgent":return"border-l-red-500 bg-red-50";case"high":return"border-l-orange-500 bg-orange-50";case"medium":return"border-l-blue-500 bg-blue-50";default:return"border-l-gray-500 bg-gray-50"}},w=async(e,s)=>{s||await b(e)},_=async()=>{await j()};return(0,r.jsxs)("div",{className:(0,h.Z)("relative",s),children:[(0,r.jsxs)("button",{onClick:()=>f(!t),className:"relative p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors duration-200","aria-label":"Notifications ".concat(p>0?"(".concat(p," unread)"):""),children:[(0,r.jsx)(o.Z,{className:"w-6 h-6"}),p>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:p>99?"99+":p})]}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-lg border border-gray-200 z-20 max-h-96 overflow-hidden",children:[(0,r.jsx)("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[p>0&&(0,r.jsx)("button",{onClick:_,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Mark all read"}),(0,r.jsx)("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(x.Z,{className:"w-5 h-5"})})]})]})}),(0,r.jsx)("div",{className:"max-h-80 overflow-y-auto",children:0===g.length?(0,r.jsxs)("div",{className:"px-4 py-8 text-center text-gray-500",children:[(0,r.jsx)(o.Z,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),(0,r.jsx)("p",{children:"No notifications yet"}),(0,r.jsx)("p",{className:"text-sm",children:"You're all caught up!"})]}):(0,r.jsx)("div",{className:"divide-y divide-gray-100",children:g.map(e=>(0,r.jsx)("div",{onClick:()=>w(e.id,e.is_read),className:(0,h.Z)("px-4 py-3 cursor-pointer transition-colors duration-150",e.is_read?"hover:bg-gray-50":"bg-blue-50 hover:bg-blue-100 border-l-4",!e.is_read&&v(e.priority||"low")),children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 mt-1",children:N(e.type)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsx)("p",{className:(0,h.Z)("text-sm font-medium truncate",e.is_read?"text-gray-700":"text-gray-900"),children:e.title}),!e.is_read&&(0,r.jsx)("div",{className:"flex-shrink-0 ml-2",children:(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})})]}),(0,r.jsx)("p",{className:(0,h.Z)("text-sm mt-1",e.is_read?"text-gray-500":"text-gray-700"),children:e.message}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,r.jsx)("span",{className:"text-xs text-gray-400",children:(0,u.Z)(new Date(e.created_at),{addSuffix:!0})}),"urgent"===e.priority&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium text-red-800 bg-red-100 rounded-full",children:"Urgent"}),"high"===e.priority&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium text-orange-800 bg-orange-100 rounded-full",children:"High"})]})]})]})},e.id))})}),g.length>0&&(0,r.jsx)("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50",children:(0,r.jsx)("button",{onClick:()=>{f(!1),window.location.href="/notifications"},className:"w-full text-sm text-blue-600 hover:text-blue-800 font-medium text-center",children:"View all notifications"})})]})]})]})}var g=t(9345),p=t(3388),b=t(2252),j=t(3229),y=t(9501),N=t(4372),v=t(1837),w=t(4362),_=t(9064);function k(e){let{className:s}=e,{user:t}=(0,w.a)(),[i,l]=(0,a.useState)(!1),[n,c]=(0,a.useState)(!1),{register:d,handleSubmit:x,watch:m,setValue:u,formState:{errors:f,isDirty:N}}=(0,y.cI)({defaultValues:{email_enabled:!0,push_enabled:!0,sms_enabled:!1,quiet_hours_start:"22:00",quiet_hours_end:"08:00",categories:{system:!0,events:!0,workshops:!0,certificates:!0,points:!0,deadlines:!0},priority_filters:{low:!0,medium:!0,high:!0,urgent:!0}}}),k=m();(0,a.useEffect)(()=>{(async()=>{if(t)try{l(!0);let m=await v.BT.getPreferences(t.id);if(m.preferences){var e,s,r,a,i,n,c,d,o,x;let t=m.preferences;u("email_enabled",t.email_enabled),u("push_enabled",t.push_enabled),u("sms_enabled",t.sms_enabled),u("quiet_hours_start",t.quiet_hours_start||"22:00"),u("quiet_hours_end",t.quiet_hours_end||"08:00");let l=t.categories?JSON.parse(t.categories):{},h=t.priority_filters?JSON.parse(t.priority_filters):{};u("categories",{system:null===(e=l.system)||void 0===e||e,events:null===(s=l.events)||void 0===s||s,workshops:null===(r=l.workshops)||void 0===r||r,certificates:null===(a=l.certificates)||void 0===a||a,points:null===(i=l.points)||void 0===i||i,deadlines:null===(n=l.deadlines)||void 0===n||n}),u("priority_filters",{low:null===(c=h.low)||void 0===c||c,medium:null===(d=h.medium)||void 0===d||d,high:null===(o=h.high)||void 0===o||o,urgent:null===(x=h.urgent)||void 0===x||x})}}catch(e){console.error("Failed to load preferences:",e),_.ZP.error("Failed to load notification preferences")}finally{l(!1)}})()},[t,u]);let Z=async e=>{if(t)try{c(!0);let s={user_id:t.id,email_enabled:e.email_enabled,push_enabled:e.push_enabled,sms_enabled:e.sms_enabled,quiet_hours_start:e.quiet_hours_start,quiet_hours_end:e.quiet_hours_end,categories:JSON.stringify(e.categories),priority_filters:JSON.stringify(e.priority_filters)};await v.BT.updatePreferences(t.id,s),_.ZP.success("Notification preferences saved successfully!")}catch(e){console.error("Failed to save preferences:",e),_.ZP.error("Failed to save preferences. Please try again.")}finally{c(!1)}};return i?(0,r.jsx)("div",{className:(0,h.Z)("bg-white rounded-lg shadow-md p-6",s),children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded w-48 mb-4"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-full"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]})}):(0,r.jsxs)("div",{className:(0,h.Z)("bg-white rounded-lg shadow-md",s),children:[(0,r.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(o.Z,{className:"w-5 h-5 text-blue-600"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Notification Preferences"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Customize how and when you receive notifications"})]}),(0,r.jsxs)("form",{onSubmit:x(Z),className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Delivery Methods"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(g.Z,{className:"w-5 h-5 text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-900",children:"Email Notifications"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Receive notifications via email"})]})]}),(0,r.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",...d("email_enabled"),className:"sr-only peer"}),(0,r.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(o.Z,{className:"w-5 h-5 text-green-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Browser and app notifications"})]})]}),(0,r.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",...d("push_enabled"),className:"sr-only peer"}),(0,r.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(p.Z,{className:"w-5 h-5 text-purple-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-900",children:"SMS Notifications"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Text messages for urgent notifications"})]})]}),(0,r.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",...d("sms_enabled"),className:"sr-only peer"}),(0,r.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quiet Hours"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),(0,r.jsx)("input",{type:"time",...d("quiet_hours_start"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),(0,r.jsx)("input",{type:"time",...d("quiet_hours_end"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"No push or SMS notifications will be sent during quiet hours"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Notification Categories"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(k.categories||{}).map(e=>{let[s,t]=e;return(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",...d("categories.".concat(s)),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-700 capitalize",children:"points"===s?"Points & Rewards":s})]},s)})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Priority Levels"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(k.priority_filters||{}).map(e=>{let[s,t]=e;return(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",...d("priority_filters.".concat(s)),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,r.jsx)("span",{className:(0,h.Z)("text-sm capitalize","urgent"===s&&"text-red-600 font-medium","high"===s&&"text-orange-600 font-medium","medium"===s&&"text-blue-600","low"===s&&"text-gray-600"),children:s})]},s)})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[(0,r.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:N&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"You have unsaved changes"})]})}),(0,r.jsx)("button",{type:"submit",disabled:n||!N,className:(0,h.Z)("inline-flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors",N&&!n?"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Saving..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Save Preferences"})]})})]})]})]})}function Z(){return(0,r.jsx)(w.AuthProvider,{children:(0,r.jsx)(m.NotificationProvider,{children:(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Notification System Demo"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Test the real-time notification center and user preferences"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-1",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Notification Center"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Click the bell icon to view notifications"}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(f,{})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Real-time Status"}),(0,r.jsx)(O,{})]})]}),(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsx)(k,{})})]})]})})})})}function O(){return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"Demo Mode - Real-time disabled"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"In production, this will show WebSocket connection status"})]})}N.Ryn({email_enabled:N.O72(),push_enabled:N.O72(),sms_enabled:N.O72(),quiet_hours_start:N.Z_8().optional(),quiet_hours_end:N.Z_8().optional(),categories:N.Ryn({system:N.O72(),events:N.O72(),workshops:N.O72(),certificates:N.O72(),points:N.O72(),deadlines:N.O72()}),priority_filters:N.Ryn({low:N.O72(),medium:N.O72(),high:N.O72(),urgent:N.O72()})})}},function(e){e.O(0,[707,501,880,563,879,971,117,744],function(){return e(e.s=8979)}),_N_E=e.O()}]);