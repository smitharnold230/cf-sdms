(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3663:function(e,t,a){Promise.resolve().then(a.bind(a,6117))},9376:function(e,t,a){"use strict";var n=a(5475);a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}})},6117:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return s}});var n=a(7437),r=a(4362),o=a(9376),i=a(2265);function s(){let{user:e,isAuthenticated:t,loading:a}=(0,r.a)(),s=(0,o.useRouter)();return((0,i.useEffect)(()=>{if(!a){if(t)switch(null==e?void 0:e.role){case"admin":s.push("/admin");break;case"faculty":s.push("/faculty");break;default:s.push("/dashboard")}else s.push("/auth/login")}},[t,a,null==e?void 0:e.role,s]),a)?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):null}},4362:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return c},a:function(){return u}});var n=a(7437),r=a(2265),o=a(1837),i=a(9064);let s=(0,r.createContext)(void 0);function c(e){let{children:t}=e,[a,c]=(0,r.useState)(null),[u,l]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&t)try{let a=JSON.parse(t);c({...a,token:e})}catch(e){localStorage.removeItem("token"),localStorage.removeItem("user")}l(!1)},[]);let d=async e=>{try{l(!0);let t=await o.iJ.login(e),a={...t.user,token:t.token};c(a),localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),i.ZP.success("Login successful!")}catch(e){var t,a;throw i.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Login failed"),e}finally{l(!1)}},f=async e=>{try{l(!0),await o.iJ.register(e),i.ZP.success("Registration successful! Please login.")}catch(e){var t,a;throw i.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Registration failed"),e}finally{l(!1)}};return(0,n.jsx)(s.Provider,{value:{user:a,loading:u,login:d,register:f,logout:()=>{c(null),localStorage.removeItem("token"),localStorage.removeItem("user"),i.ZP.success("Logged out successfully")},isAuthenticated:!!a,hasRole:e=>!!a&&e.includes(a.role)},children:t})}function u(){let e=(0,r.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1837:function(e,t,a){"use strict";a.d(t,{Aw:function(){return s},BT:function(){return u},Hc:function(){return o},Wp:function(){return c},iJ:function(){return r},vd:function(){return i}});let n=a(3464).Z.create({baseURL:"http://127.0.0.1:8787",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),n.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),Promise.reject(e)});let r={login:async e=>(await n.post("/auth/login",e)).data,register:async e=>(await n.post("/auth/register",e)).data},o={uploadCertificate:async e=>{let t=new FormData;return t.append("file",e.file),(await n.post("/certificates/upload?user_id=".concat(e.user_id,"&title=").concat(encodeURIComponent(e.title),"&issued_date=").concat(e.issued_date),t,{headers:{"Content-Type":"application/pdf"}})).data},getUserCertificates:async e=>(await n.get("/users/".concat(e,"/certificates"))).data,downloadCertificate:async e=>(await n.get("/certificates/".concat(e,"/download"),{responseType:"blob"})).data,deleteCertificate:async e=>(await n.delete("/certificates/".concat(e))).data,reviewCertificate:async(e,t,a)=>(await n.put("/certificates/".concat(e,"/review"),{status:t,rejection_reason:a})).data},i={getEvents:async()=>({events:(await n.get("/api/events")).data}),createEvent:async e=>{let t=await n.post("/api/faculty/events",e);return{event:{...e,id:t.data.eventId}}}},s={getWorkshops:async()=>{try{return{workshops:(await n.get("/api/workshops")).data}}catch(e){return{workshops:[]}}},createWorkshop:async(e,t)=>{let a=await n.post("/api/faculty/workshops?eventId=".concat(e),t);return{workshop:{...t,id:a.data.workshopId,event_id:e}}}},c={getUserPoints:async e=>{let t=await n.get("/api/analytics/user?userId=".concat(e));return{total_points:t.data.data.totalPoints,entries:t.data.data.pointsHistory}},addPoints:async(e,t,a)=>(await n.post("/api/admin/award-points",{userId:e,points:t,reason:a})).data},u={getNotifications:async e=>(await n.get("/api/notifications/".concat(e))).data,markAsRead:async e=>(await n.put("/api/notifications/".concat(e,"/read"))).data,markAllAsRead:async e=>(await n.put("/api/notifications/".concat(e,"/read-all"))).data,getPreferences:async e=>(await n.get("/api/notifications/".concat(e,"/preferences"))).data,updatePreferences:async(e,t)=>(await n.put("/api/notifications/".concat(e,"/preferences"),t)).data}}},function(e){e.O(0,[707,971,117,744],function(){return e(e.s=3663)}),_N_E=e.O()}]);